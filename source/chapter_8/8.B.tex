\section{8.B Decomposition of an Operator}

\begin{theorem}[8.21]\label{thm 8.21} 广义特征空间分解 \:
    
    设\(V\)是有限维复向量空间且\(T \in L(V)\)，\(\lambda_1,\cdots,\lambda_m\)是\(T\)所有的相异特征值.求证：

    a.\(\forall i=1,\cdots,m,G(\lambda_i,T)\)是\(T\)下的不变子空间.
    
    b.\(\forall i=1,\cdots,m,(T-\lambda_i I)|_{G(\lambda_i,T)}\)是幂零算子.
    
    c.\(V\)有一组由\(T\)的广义特征向量组成的基.
    
    d.\(V=\oplus_{i=1}^m G(\lambda_i,T)\).
\end{theorem}

\begin{lemma}[8.20]\label{lem 8.20}
    \(\ker p(T)\)和\(\operatorname{Im} p(T)\)是\(T\)下的不变子空间.
\end{lemma}

\begin{proof}[引理证明]
    对\(\ker p(T)\)和\(\operatorname{Im} p(T)\)逐一验证即可.

    \(\forall v \in \ker p(T),p(T)(Tv)=T(p(T)v)=0 \Rightarrow Tv \in \ker p(T)\).
    
    \(\forall v \in \operatorname{Im} p(T),\exists u \in V,p(T)u=v \Rightarrow Tv=T(p(T)u)=p(T)(Tu),Tv \in \operatorname{Im} p(T)\).
\end{proof}

\begin{proof}[证明a]
    考虑\(p(z)=(z-\lambda_i)^n\)，从而\(\ker p(T)=G(\lambda_i,T)\).

    根据引理8.20，\(G(\lambda_i,T)\)是\(T\)下的不变子空间.
\end{proof}

\begin{proof}[证明b]
    \(\ker (T-\lambda_i I)^n=G(\lambda_i,T)\)，显然\((T-\lambda_i I)|_{G(\lambda_i,T)}\)是幂零算子.
\end{proof}

\begin{proof}[证明c]
    使用第二数学归纳法，设\(\dim V=n\).当\(n=1\)时，\(V=G(\lambda,T)\)，命题成立.

    设对于任意有限维复向量空间\(U\)和\(R \in L(U)\)满足\(\dim U<\dim V\)，结论均成立.
    
    由\(V=\ker (T-\lambda_1 I)^n \oplus \operatorname{Im} (T-\lambda_1 I)^n\)，令\(U=\operatorname{Im} (T-\lambda_1 I)^n\).
    
    由\(U\)是\(T\)下的不变子空间且满足\(\dim U<\dim V\)，因而\(U\)有一组\(T|_U\)的广义特征基.
    
    \(G(\lambda_1,T)\)作为\(V\)的广义特征子空间显然有\(T|_{G(\lambda_i,T)}\)的广义特征基.
    
    将\(G(\lambda_1,T)\)和\(U\)的广义特征基合并，就得到了\(V\)由\(T\)的广义特征向量组成的基.
\end{proof}

\begin{proof}[证明d]
    c部分中构造的每个广义特征向量均属于一个特定的广义特征子空间.

    将这些向量按照所属空间重新标号为\(v_1^i,\cdots,v_{n_i}^i,i=1,\cdots,m\)，上标\(i\)表示第\(i\)个特征值.

    令\(U_i=\operatorname{span}(v_1^i,\cdots,v_{n_i}^i)\)，则\(V=\oplus_{i=1}^m U_i,\dim V=\sum_{i=1}^m \dim U_i\).

    同时\(\forall i=1,\cdots,m,U_i \subseteq G(\lambda_i,T)\).
    于是\(\forall i=1,\cdots,m,\dim U_i \leq \dim G(\lambda_i,T)\).

    由于广义特征子空间之和为直和，得到
    \begin{align*}
        \dim \oplus_{i=1}^m G(\lambda_i,T)=\sum_{i=1}^m \dim G(\lambda_i,T) \geq \sum_{i=1}^m \dim U_i=\dim V
    \end{align*}
    于是只能取等，有\(\forall i=1,\cdots,m,\dim U_i=\dim G(\lambda_i,T)\)，即\(U_i=G(\lambda_i,T)\).

    从而\(V=\oplus_{i=1}^m U_i=\oplus_{i=1}^m G(\lambda_i,T)\)，证毕.
\end{proof}

\newpage

\begin{problem}[8.33]\label{thm 8.33} 可逆算子的平方根 \:
    设\(V\)是有限维复向量空间，\(T \in L(V)\)是可逆算子.

    证明：\(T\)存在一个平方根\(R\)，使得\(R^2=T\).
\end{problem}

\begin{lemma}[8.31]\label{lem 8.31}
    若\(N \in L(V)\)是幂零算子，则\(I+N\)有一个平方根\(R\).
\end{lemma}

\begin{proof}[引理证明]
    根据\(\sqrt{1+x}=\sum_{i=1}^\infty a_ix^i,a_0=1\)，
    可以猜想\(I+N\)的平方根具有类似形式
    \begin{align*}
        R=\sum_{i=1}^{m-1} a_iN^i,a_0=1,N^m=0
    \end{align*}
    因此尝试对左右两边平方，得到
    \begin{align*}
        I+N = (\sum_{i=1}^{m-1} a_iN^i)^2 
            = I+2a_1N+\sum_{i=2}^{m-1} (2a_i+f(a_1,\cdots,a_{i-1}))N^i
    \end{align*}
    显然\(a_1=\dfrac{1}{2}\).对于第\(i\)项，其中的\(f(a_1,\cdots,a_{i-1})\)是已知的.
    
    因此只需解出\(a_i\)，使得\(2a_i+f(a_1,\cdots,a_{i-1})=0\)即可.
\end{proof}

\begin{proof}[定理证明]
    设\(\lambda_1,\cdots,\lambda_m\)是\(T\)的所有不同特征值.

    根据定理8.21，\(N_i=(T-\lambda_i I)|_{G(\lambda_i,T)}\)是幂零算子.
    因此可以将\(T|_{G(\lambda_i,T)}\)分解为
    \begin{align*}
        \forall i=1,\cdots,m,T|_{G(\lambda_i,T)}=\lambda_i(I+\dfrac{N_i}{\lambda_i})
    \end{align*}
    由于\(T\)是可逆变换，因而\(\lambda_1,\cdots,\lambda_m \ne 0\)，该式自然成立.
    据引理，\(T|_{G(\lambda_i,T)}\)有平方根\(R_i\).
    
    由于\(V=\oplus_{i=1}^m G(\lambda_i,T)\)，
    因此\(\forall v \in V,\exists u_i \in G(\lambda_i,T),v=\sum_{i=1}^m u_i\).定义\(R\)为
    \begin{align*}
        Rv=\sum_{i=1}^m R_iu_i i=1,\cdots,m \Rightarrow
        R^2v=\sum_{i=1}^m R_i^2 u_i=\sum_{i=1}^m T|_{G(\lambda_i,T)}u_i=Tv
    \end{align*}
    因此\(R\)是\(T\)的一个平方根.
\end{proof}

\newpage

\begin{problem}[3]\label{8.B.3}
    设\(T,S \in L(V)\)，且\(S\)是可逆算子.证明：\(T\)和\(S^{-1}TS\)的特征值有相同的重数.
\end{problem}

\begin{proof}
    根据\probref{5.A.15}，\(T\)和\(S^{-1}TS\)拥有相同的特征值，设\(\lambda\)是其中之一.

    现在考虑\((S^{-1}TS-\lambda I)^{\dim V}\).根据\probref{5.B.5}，
    \begin{align*}
        (S^{-1}TS-\lambda I)^{\dim V}&=(S^{-1}TS-\lambda S^{-1}S)^{\dim V}=(S^{-1}(TS-\lambda S))^{\dim V} \\
        &=(S^{-1}(T-\lambda I)S)^{\dim V}=S^{-1}(T-\lambda I)^{\dim V}S
    \end{align*}
    对于\(v \in \ker G(\lambda,T)\)，考虑\(S^{-1}v\)，有\((S^{-1}(T-\lambda I)^{\dim V}S)(S^{-1}v)=S((T-\lambda I)^{\dim V}v)=0\).
    
    因此\(S^{-1}(G(\lambda,T)) \subseteq G(\lambda,S^{-1}TS)\)，同理\(S(G(\lambda,S^{-1}TS)) \subseteq G(\lambda,T)\).
    
    从而\(\dim G(\lambda,T)=\dim G(\lambda,S^{-1}TS)\).
\end{proof}

\begin{problem}[5]\label{8.B.5}
    设\(V\)是有限维复向量空间且\(T \in L(V)\).

    求证：\(T\)有由特征向量组成的基等价于\(T\)的所有广义特征向量都是特征向量.
\end{problem}

\begin{proof}
    必要性：根据定理8.23，\(T\)有一组由广义特征向量组成的基.

    而\(T\)的所有广义特征向量都是特征向量，从而\(T\)有由特征向量组成的基.
    
    充分性：设\(\lambda_1,\cdots,\lambda_m\)是\(T\)的不同特征值.
    
    根据定理5.41，\(T\)有由特征向量组成的基等价于\(V=\oplus_{i=1}^m E(\lambda_i,T)\).
    结合\(V=\oplus_{i=1}^m G(\lambda_i,T)\)，
    
    并由定理8.13指出的广义特征向量的无关性，得\(\forall i=1,\cdots,m,G(\lambda_i,T)=E(\lambda_i,T)\).
    
    即\(T\)的所有广义特征向量都是特征向量，证毕.
\end{proof}

\begin{problem}[7]\label{8.B.7}
    设\(V\)是复向量空间且\(T \in L(V)\)，求证：\(\forall T \in L(V),\exists S \in L(V),S^3=T\).
\end{problem}

\begin{proof}
    参考引理8.31的证明，猜想\(I+N\)的立方根也具有形式
    \begin{align*}
        R=\sum_{i=1}^{m-1} a_iN^i,a_0=1,N^m=0
    \end{align*}
    令\(R^3=I+N\)，得到
    \begin{align*}
        I+N=I+3a_1N+\sum_{i=2}^{m-1} (2a_i+f(a_1,\cdots,a_{i-1}))N^i
    \end{align*}
    得到\(a_1=\dfrac{1}{3}\)，依次解出剩下的\(a_2,\cdots,a_{m-1}\)即可，
    下设\(\lambda_1,\cdots,\lambda_m\)是\(T\)的不同特征值.

    考虑幂零算子\(N_i=(T-\lambda_i I)|_{G(\lambda,T)}\)，
    将\(T|_{G(\lambda_i,T)}\)分解为\(\lambda_i(I+\dfrac{N_i}{\lambda_i})\).

    从而\(\forall i=1,\cdots,m\)，\(N_i\)都有立方根\(R_i\).

    由于\(V=\oplus_{i=1}^m G(\lambda_i,T)\)，
    因此\(\forall v \in V,\exists u_i \in G(\lambda_i,T),v=\sum_{i=1}^m u_i\).

    定义\(R\)为\(Rv=\sum_{i=1}^m R_iu_i\)，则\(R\)是\(T\)的一个立方根，证毕.
\end{proof}

\newpage

\begin{problem}[10]\label{8.B.10}
    设\(V\)是有限维复向量空间且\(T \in L(V)\).

    求证：存在\(D,N \in L(V)\)满足\(T=D+N\)且\(D\)可对角化，\(N\)是幂零算子，\(DN=ND\).
\end{problem}

\begin{proof}
    设\(\lambda_1,\cdots,\lambda_m\)是\(T\)的不同特征值，考虑\(T|_{G(\lambda_i,T)}\).

    令\(D_i=\lambda_i I|_{G(\lambda_i,T)},N_i=(T-\lambda_i I)|_{G(\lambda_i,T)}\)，
    显然\(D_i\)可对角化，\(N_i\)是幂零算子.
    
    根据定理8.21，\(V=\oplus_{i=1}^m G(\lambda_i,T)\).
    因此\(\forall v \in V,\exists v_i \in G(\lambda_i,T),v=\sum_{i=1}^m v_i\).
    
    分别定义\(D\)和\(N\)为\(Dv=\sum_{i=1}^m D_iv_i,Nv=\sum_{i=1}^m N_iv_i\).
    
    \(M(D)\)只有对角线元素不为\(0\)，即\(D\)可对角化；\(M(N)\)的对角线元素均为\(0\)，即\(N\)是幂零算子.
    
    下证\(DN=ND\).考虑\(\forall v \in V\)，有
        \begin{align*}
            (ND)v=N\sum_{i=1}^m D_iv_i=\sum_{i=1}^m \lambda_iN_iv_i=(DN)v
        \end{align*}
\end{proof}

\begin{problem}[11]\label{8.B.11}
    设\(V\)满足是有限维复向量空间且\(T \in L(V)\)，全部相异特征值为\(\lambda_1, \dots, \lambda_m\).

    设\(v_1, \dots, v_n\)是\(V\)的一组基，并满足\(M(T,(v_1, \dots, v_n))\)是上三角矩阵.
    
    求证：\(T\)的每个特征值\(\lambda_i\)在矩阵对角线上出现的次数即为\(\lambda_i\)作为\(T\)的特征值的代数重数.
\end{problem}

\begin{lemma}
    设\(M(T,(v_1, \dots, v_n))\)的对角线元素依次为\(c_1, \dots, c_n\)，从中依次抽取\(c_{k_1}, \dots, c_{k_p} \ne 0\).

    设这些元素对应的基向量为\(v_{k_1}, \dots, v_{k_p}\)，那么\(Tv_{k_1}, \dots, Tv_{k_p}\)线性无关.
\end{lemma}

\begin{proof}[引理证明]
    设\(U_i=\operatorname{span}(v_1, \dots, v_i)\)，考虑\(V/U, T/U \in \mathcal{L}(V/U), \pi_i(v)=v+U_i\).

    考虑\(\sum_{i=1}^p a_iTv_{k_p}=0\)，对等式两侧施加算子\(\pi_{k_p-1}\)，有
    \begin{align*}
        \pi_{k_p-1}(\sum_{i=1}^p a_iTv_{k_i})=a_pc_{k_p}v_{k_p}+U_{k_p-1}=0
    \end{align*}
    由于\(c_{k_p} \ne 0\)，因而\(a_p=0\).依次施加\(\pi_{k_{p-1}-1}, \dots, \pi_{k_1-1}\)，得到\(a_p^k=\dots=a_1^k=0\).
\end{proof}

\begin{proof}[定理证明]
    设\(\lambda_i\)在对角线上出现的次数为\(d_i\)，有\(\sum_{i=1}^m d_i=n\).考虑\(M((T-\lambda_i I)^n, (v_1, \dots, v_n))\).

    显然\(M((T-\lambda_i I)^n)\)对角线上的非零元素有\(n-d_i\)个.根据引理，\(\dim \operatorname{Im} ((T-\lambda_i I)^n) \geq n-d_i\).

    由\(\dim V=\dim G(\lambda_i,T) \oplus \dim \operatorname{Im}(T-\lambda_i I)^n\)，得\(\dim G(\lambda_i,T) \leq d_i\).

    然而\(\dim V=\sum_{i=1}^n \dim G(\lambda_i,T) \leq \sum_{i=1}^n d_i=\dim V\)，故\(\forall i=1, \dots, m, \dim G(\lambda_i,T)=d_i\).
\end{proof}
% End: source/chapter_8/8.B.tex

